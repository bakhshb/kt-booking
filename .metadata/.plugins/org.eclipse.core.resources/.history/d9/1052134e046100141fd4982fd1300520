package com.kiwianatours.ktbooking.web.rest;

import javax.servlet.annotation.MultipartConfig;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;

@WebServlet(name = "uploads",urlPatterns = {"/uploads/*"})
@MultipartConfig
public class Uploads extends HttpServlet {
	private static final long serialVersionUID = 2857847752169838915L;
	int BUFFER_LENGTH = 4096;
	
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		 
	    PrintWriter out = response.getWriter();
	    for (Part part : request.getParts()) {
	        InputStream is = request.getPart(part.getName()).getInputStream();
	        String fileName = getFileName(part);
	        FileOutputStream os = new FileOutputStream(System.getenv("OPENSHIFT_DATA_DIR") + fileName);
	        byte[] bytes = new byte[BUFFER_LENGTH];
	        int read = 0;
	        while ((read = is.read(bytes, 0, BUFFER_LENGTH)) != -1) {
	            os.write(bytes, 0, read);
	        }
	        os.flush();
	        is.close();
	        os.close();
	        out.println(fileName + " was uploaded to " + System.getenv("OPENSHIFT_DATA_DIR"));
	    }
	  }
}
